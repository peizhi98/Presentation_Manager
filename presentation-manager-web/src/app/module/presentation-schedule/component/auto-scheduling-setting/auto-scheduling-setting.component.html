<div class="pl-2 pt-1"
     style="font: 300 28px/33px Roboto, 'Helvetica Neue', sans-serif;">Auto-scheduling
</div>
<mat-horizontal-stepper [linear]="isLinear" #stepper>
  <!--  first step-->
  <mat-step>
    <form [formGroup]="firstFormGroup">
      <ng-template matStepLabel>Select presentation to schedule</ng-template>
      <ng-container *ngIf="presentationModels">
        <table mat-table matSort class="w-100" *ngIf="dataSource" [dataSource]="dataSource">
          <!-- name Column -->
          <ng-container [matColumnDef]=displayedColumns[0]>
            <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 15%">Student Name</th>
            <td mat-cell *matCellDef="let row" style="width: 15%">{{row.studentName}}</td>
          </ng-container>

          <!-- title Column -->
          <ng-container [matColumnDef]=displayedColumns[1]>
            <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 40%">Title</th>
            <td mat-cell *matCellDef="let row" style="width: 40%">{{row.title}}</td>
          </ng-container>

          <!-- schedule time Column -->
          <ng-container [matColumnDef]=displayedColumns[2]>
            <th mat-header-cell *matHeaderCellDef mat-sort-header style="width: 25%">Scheduled Time</th>
            <td mat-cell *matCellDef="let row" style="width: 25%">{{(row.startTime|date:timeFormat)}}
              - {{(row.endTime|date:timeFormat)}}</td>
          </ng-container>

          <!-- check Column -->
          <ng-container [matColumnDef]=displayedColumns[3]>
            <th mat-header-cell *matHeaderCellDef style="width: 20%">Auto Schedule to</th>
            <td mat-cell *matCellDef="let row" style="width: 20%">
              <div style="display: inline-block" class="ml-2">
                <mat-checkbox class="ml-1" (click)="disableOtherModeIfThisChecked(row,PresentationMode.ONLINE)"
                              [(ngModel)]="row.online" [ngModelOptions]="{standalone: true}"
                              [value]="PresentationMode.ONLINE">Online
                </mat-checkbox>
                <mat-checkbox class="ml-1" (click)="disableOtherModeIfThisChecked(row,PresentationMode.PHYSICAL)"
                              [(ngModel)]="row.physical" [ngModelOptions]="{standalone: true}"
                              [value]="PresentationMode.PHYSICAL">Physical
                </mat-checkbox>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

        </table>
      </ng-container>
      <div class="pt-1">
        <button mat-raised-button color="primary" matStepperNext>Next</button>
      </div>
    </form>
  </mat-step>

  <!--  second step-->
  <mat-step [stepControl]="secondFormGroup" label="Manage Presentation Slots">
    <form [formGroup]="secondFormGroup">
      <div>Presentations will be auto-scheduled according to the presentation slot.</div>
      <app-scheduler #slotScheduler></app-scheduler>
    </form>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Generate</ng-template>
    <ng-container *ngIf="form">
      <form  [formGroup]="form">
        <div>Presentation Duration:
          <mat-form-field style="width: 10%" appearance="fill">
            <mat-label>minutes</mat-label>
            <input type="number" min="1" matInput [formControl]="form.get('duration')" >
            <mat-error *ngIf="form.get('duration').invalid&&form.get('duration').touched">Please enter a valid presentation duration.
            </mat-error>
          </mat-form-field>
        </div>
      </form>
    </ng-container>


    <div>
      <button mat-raised-button color="primary" (click)="generate()">Generate</button>
    </div>
  </mat-step>
</mat-horizontal-stepper>
<ng-container *ngIf="resourceDataSource&&selectedDate">
  <ejs-schedule #scheduleObj cssClass='adaptive-rows' height='650px' [rowAutoHeight]='rowAutoHeight'
                [currentView]="currentView" [selectedDate]="selectedDate"
                [group]="group" (actionBegin)="onActionBegin($event)"
                [eventSettings]="eventSettings" cdkDropList [cdkDropListData]="scheduledPresentations"
                (cdkDropListDropped)="drop($event)" (dragStart)="onSchedulerDragStart($event)"
                (dragStop)="onSchedulerDragStop($event)"
                (resizeStart)="onResizeStart($event)" (resizeStop)="onResizeStop($event)"
                (eventRendered)="onEventRendered($event)"
                (cellDoubleClick)="disablePopupOpen($event)" (cellClick)="disablePopupOpen($event)">


    <e-resources>
      <e-resource field='roomId' title='Room Type' [dataSource]='resourceDataSource' [allowMultiple]='allowMultiple'
                  name='MeetingRoom' textField='name' idField='id' colorField='color'>
      </e-resource>
    </e-resources>
    <e-views>
      <e-view option="TimelineDay"></e-view>
      <e-view option="TimelineWeek"></e-view>
    </e-views>
  </ejs-schedule>
</ng-container>
